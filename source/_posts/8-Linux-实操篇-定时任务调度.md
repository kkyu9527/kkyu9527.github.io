---
title: 🕒 8-Linux 实操篇 - 定时任务调度
date: 2025-03-05 14:00:00
categories: [Linux]
tags: [Linux, 定时任务, Cron, Crontab, AT, 自动化运维]
author: "kkyu9527"
cover: /images/LinuxNode/LinuxNodeCover.png
---

# 🕒 8-Linux 实操篇 - 定时任务调度

## 🎯 8.1 crond 任务调度

### 📌 8.1.1 概述

在 Linux 中，定时任务调度指的是在特定时间自动执行任务的一种机制，通常用于自动化任务执行，例如数据备份、日志清理和定期检查服务状态等。

🖥 **应用场景：**
- 定时备份数据库 📦
- 定期清理日志文件 🧹
- 自动同步文件 📂

### 🔧 8.1.2 crontab 基本语法

```shell
crontab [-e|-l|-r]
```

| 选项 | 功能            |
|----|---------------|
| -e | 编辑定时任务        |
| -l | 查看当前用户的定时任务   |
| -r | 删除当前用户所有的定时任务 |

### 🚀 8.1.3 cron 任务配置

crontab 的任务配置格式如下：

```shell
* * * * * 执行命令
```

| 字段 | 说明      | 范围         |
|----|---------|------------|
| 1  | 分钟      | 0-59       |
| 2  | 小时      | 0-23       |
| 3  | 每月第几天   | 1-31       |
| 4  | 月份      | 1-12       |
| 5  | 一周中的第几天 | 0-6 (0为周日) |

### ⚙️ 8.1.3 特殊符号

| 符号  | 说明           | 示例                            |
|-----|--------------|-------------------------------|
| *   | 任意时间         | 每分钟执行：`* * * * *`             |
| ,   | 指定多个时间点（不连续） | `0 8,12,16 * * *` 每天的8,12,16点 |
| -   | 指定时间范围       | `0 2 * * 1-5` (周一至周五凌晨2点)     |
| */n | 每隔n单位执行一次    | `*/5 * * * *` 每5分钟一次          |

### 🔍 8.1.4 实操案例

案例：每1分钟记录当前日期到文件

```shell
*/1 * * * * date >> ~/time.log
```

案例：每日凌晨3点备份MySQL数据库

```shell
0 3 * * * mysqldump -uroot -proot mydb > /home/backup/db.bak
```

## 🚀 8.2 at 一次性定时任务

### 📌 8.2.1 at 基本介绍

`at` 命令用于设置一次性定时任务，执行一次后任务将自动删除。

### 🧰 8.2.2 基本语法

```shell
at [时间]
# 输入命令后按 Ctrl+D 结束输入
```

### 🔑 8.2.3 常用选项

| 选项    | 功能说明        |
|-------|-------------|
| -m    | 任务执行完发送邮件通知 |
| -f 文件 | 从文件读取任务执行   |
| -t 时间 | 以指定时间参数执行任务 |

### ⚙️ 8.2.2 使用示例

案例1：设置晚上8点执行一次任务，输出系统日期到文件

```shell
at 20:00
at> date > ~/today.txt
Ctrl+D
```

案例2: 使用 at 设置在2024年5月30日23:00备份数据库

```shell
at -t 202405302300
mysqldump -u root -p mydb > /home/db_backup.sql
Ctrl+D  # 完成任务设置
```

## 📖 8.3 crond 与 at 的对比

| 工具    | 场景          | 执行频率       |
|-------|-------------|------------|
| crond | 周期性任务执行（定期） | 每天、每周等重复执行 |
| at    | 一次性任务执行     | 一次执行后自动删除  |

## 📚 8.3.1 查看定时任务

- 查看当前用户的 cron 任务
```shell
crontab -l
```

- 查看所有用户的 cron 任务
```shell
sudo cat /etc/crontab
```

## 🚮 8.3.2 删除定时任务

- 删除当前用户所有任务
```shell
crontab -r
```

- 删除指定的 at 任务
```shell
atrm [任务号]
```

## 🎯 8.4 小结

🔸 熟悉 `crontab` 和 `at` 指令，满足服务器日常自动化管理。
🔸 灵活使用定时任务，有效提高运维效率和自动化程度。
🔸 推荐经常备份关键数据，避免数据丢失！💡

