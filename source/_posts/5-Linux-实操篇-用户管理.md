---
title: 👤 5-Linux 实操篇 - 用户管理

date: 2025-02-28 20:00:00
categories: [Linux]
tags: [Linux, 用户管理, 权限, 组管理]
author: "kkyu9527"
cover: /images/LinuxNode/LinuxNodeCover.png
---

# 👤 5-Linux 实操篇 - 用户管理

## 🎯 5.1 基本介绍

Linux 是一个 **多用户多任务的操作系统**，每个用户都需要账号才能使用系统资源。通过用户管理，系统可以控制每个用户的权限，确保系统的 **安全性和可控性**。

🔹 **为什么要学习用户管理？**
✅ **系统安全**：防止未授权访问，确保系统稳定。
✅ **权限分配**：不同用户有不同的访问权限，避免误操作。
✅ **高效协作**：合理的用户管理有助于团队开发和运维。

---

## 👥 5.2 添加用户

### 📌 5.2.1 基本语法

```bash
useradd 用户名 -m  # 创建用户并分配家目录
adduser 用户名    # 自动分配家目录（交互式创建）
```

### 🛠️ 5.2.2 应用案例

案例：添加一个 `milan` 用户，默认家目录在 `/home/milan/`
```bash
useradd milan -m
```

### 🔍 5.2.3 细节说明

1️⃣ **创建用户时，默认会创建与用户名相同的家目录**。
2️⃣ **可以使用 `useradd -d 目录名 用户名` 指定用户家目录**。
3️⃣ **新用户默认使用 `/bin/sh` 作为 shell，可以手动切换到 `/bin/bash`**。

---

## 🔑 5.3 指定/修改用户密码

### 📌 5.3.1 基本语法
```bash
passwd 用户名  # 修改指定用户的密码
```

### 🛠️ 5.3.2 应用案例

案例：给 `test` 用户指定密码
```bash
passwd test
```

🔹 **显示当前用户所在目录**
```bash
pwd
```

---

## ❌ 5.4 删除用户

### 📌 5.4.1 基本语法
```bash
userdel 用户名  # 仅删除用户，不删除其家目录
userdel -r 用户名  # 删除用户及其家目录
```

### 🛠️ 5.4.2 应用案例

案例：删除 `test` 用户但保留家目录
```bash
userdel test
```
案例：删除 `test1` 用户及其主目录
```bash
userdel -r test1
```

### 🔍 5.4.3 细节说明

1️⃣ **一般建议保留用户的家目录，以备恢复数据**。
2️⃣ **删除用户不会影响其他用户和系统正常运行**。

---

## 🔎 5.5 查询用户信息

### 📌 5.5.1 基本语法
```bash
id 用户名  # 查看用户 ID、组 ID、附加组等信息
```

### 🛠️ 5.5.2 应用案例

案例：查询 `root` 用户的信息
```bash
id root
```

### 🔍 5.5.3 细节说明

1️⃣ **如果用户不存在，`id` 命令会返回“无此用户”**。
2️⃣ **可用 `whoami` 查看当前登录的用户**。

---

## 🔄 5.6 切换用户

### 📌 5.6.1 基本语法
```bash
su - 用户名  # 切换到指定用户
```

### 🛠️ 5.6.2 应用案例

创建 `jack` 用户并切换到该用户
```bash
useradd jack -m
passwd jack
su - jack
```

### 🔍 5.6.3 细节说明

1️⃣ **从 root 切换到普通用户不需要密码，但反之需要输入密码**。
2️⃣ **退出当前用户，返回上一级用户，使用 `exit` 或 `logout`**。

---

## 🧑‍💻 5.7 查看当前用户

### 📌 5.7.1 基本语法
```bash
whoami  # 显示当前会话的用户
who am i  # 显示首次登录的用户
```

---

## 🏷️ 5.8 用户组管理

Linux **支持用户分组**，可以对具有相同权限的用户进行统一管理。

### 📌 5.8.1 创建用户组
```bash
groupadd 组名  # 新建用户组
```

### 📌 5.8.2 删除用户组
```bash
groupdel 组名  # 删除用户组
```

### 🛠️ 5.8.3 添加用户到组
```bash
useradd -g 组名 用户名  # 创建用户并指定所属组
```

案例：创建 `wudang` 组，并将 `zhangwuji` 用户加入该组
```bash
groupadd wudang
useradd -g wudang zhangwuji
```

### 📌 5.8.4 修改用户的组
```bash
usermod -g 新组名 用户名  # 修改用户所属的组
```

案例：把 `zhangwuji` 迁移到 `mojiao` 组
```bash
usermod -g mojiao zhangwuji
```

---

## 📂 5.9 用户和组相关文件

### 📌 5.9.1 `/etc/passwd` - 用户信息存储文件

每个用户信息存储在 `/etc/passwd` 文件，每行结构如下：
```plaintext
用户名: 口令: 用户 ID: 组 ID: 说明: 主目录: Shell
```

示例：
```plaintext
zhangwuji:x:1001:1001:Zhang Wuji:/home/zhangwuji:/bin/bash
```

### 📌 5.9.2 `/etc/shadow` - 用户密码存储文件

包含用户密码的加密信息，每行格式如下：
```plaintext
用户名: 加密密码: 最后修改时间: 最小时间间隔: 最大时间间隔: 警告时间: 不活动时间: 失效时间
```

### 📌 5.9.3 `/etc/group` - 组信息存储文件

包含所有用户组的信息，每行格式如下：
```plaintext
组名: 组密码: 组 ID: 组内用户列表
```

示例：
```plaintext
wudang:x:1002:zhangwuji,zhangsan
```

---

## 🎉 5.10 总结

✅ **掌握 `useradd`、`passwd`、`userdel` 创建、修改和删除用户**。
✅ **学会 `su`、`id`、`whoami` 进行用户切换和信息查询**。
✅ **掌握 `groupadd`、`usermod -g` 进行用户组管理**。
✅ **了解 `/etc/passwd`、`/etc/shadow`、`/etc/group` 用户管理文件**。
